{"ast":null,"code":"import _asyncToGenerator from \"/Users/futorine/dev/holochain/holochain-engineers/team-mates/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/**\n * Defines AdminWebsocket, an easy-to-use websocket implementation of the\n * Conductor Admin API\n *\n *    const client = AdminWebsocket.connect(\n *      'ws://localhost:9000'\n *    )\n *\n *    client.generateAgentPubKey()\n *      .then(agentPubKey => {\n *        console.log('Agent successfully generated:', agentPubKey)\n *      })\n *      .catch(err => {\n *        console.error('problem generating agent:', err)\n *      })\n */\nimport * as Api from \"./types.js\";\nimport { WsClient } from \"../client.js\";\nimport { catchError, promiseTimeout, DEFAULT_TIMEOUT } from \"../common.js\";\nimport { requesterTransformer } from \"../common.js\";\nimport { getLauncherEnvironment } from \"../../environments/launcher.js\";\nexport class AdminWebsocket {\n  client;\n  defaultTimeout;\n\n  constructor(client, defaultTimeout) {\n    this.client = client;\n    this.defaultTimeout = defaultTimeout === undefined ? DEFAULT_TIMEOUT : defaultTimeout;\n  }\n\n  static connect(url, defaultTimeout) {\n    return _asyncToGenerator(function* () {\n      // Check if we are in the launcher's environment, and if so, redirect the url to connect to\n      const env = yield getLauncherEnvironment();\n\n      if (env) {\n        url = `ws://localhost:${env.ADMIN_INTERFACE_PORT}`;\n      }\n\n      const wsClient = yield WsClient.connect(url);\n      return new AdminWebsocket(wsClient, defaultTimeout);\n    })();\n  }\n\n  _requester = (tag, transformer) => requesterTransformer((req, timeout) => promiseTimeout(this.client.request(req), tag, timeout || this.defaultTimeout).then(catchError), tag, transformer); // the specific request/response types come from the Interface\n  // which this class implements\n\n  attachAppInterface = this._requester(\"attach_app_interface\"); // Deprecated\n\n  activateApp = this._requester(\"activate_app\"); // Deprecated\n\n  deactivateApp = this._requester(\"deactivate_app\");\n  enableApp = this._requester(\"enable_app\");\n  disableApp = this._requester(\"disable_app\");\n  startApp = this._requester(\"start_app\");\n  dumpState = this._requester(\"dump_state\", dumpStateTransform);\n  dumpFullState = this._requester(\"dump_full_state\");\n  generateAgentPubKey = this._requester(\"generate_agent_pub_key\");\n  registerDna = this._requester(\"register_dna\");\n  installApp = this._requester(\"install_app\");\n  uninstallApp = this._requester(\"uninstall_app\");\n  installAppBundle = this._requester(\"install_app_bundle\");\n  createCloneCell = this._requester(\"create_clone_cell\");\n  listDnas = this._requester(\"list_dnas\");\n  listCellIds = this._requester(\"list_cell_ids\"); // Deprecated\n\n  listActiveApps = this._requester(\"list_active_apps\");\n  listApps = this._requester(\"list_apps\", listAppsTransform);\n  listAppInterfaces = this._requester(\"list_app_interfaces\");\n  requestAgentInfo = this._requester(\"request_agent_info\");\n  addAgentInfo = this._requester(\"add_agent_info\");\n}\nconst listAppsTransform = {\n  input: req => {\n    const args = {};\n\n    if (req.status_filter) {\n      args.status_filter = getAppStatusInApiForm(req.status_filter);\n    }\n\n    return args;\n  },\n  output: res => res\n};\nconst dumpStateTransform = {\n  input: req => req,\n  output: res => {\n    return JSON.parse(res);\n  }\n};\n\nfunction getAppStatusInApiForm(status_filter) {\n  switch (status_filter) {\n    case Api.AppStatusFilter.Running:\n      return {\n        Running: null\n      };\n\n    case Api.AppStatusFilter.Enabled:\n      return {\n        Enabled: null\n      };\n\n    case Api.AppStatusFilter.Paused:\n      return {\n        Paused: null\n      };\n\n    case Api.AppStatusFilter.Disabled:\n      return {\n        Disabled: null\n      };\n\n    case Api.AppStatusFilter.Stopped:\n      return {\n        Stopped: null\n      };\n  }\n}","map":{"version":3,"sources":["/Users/futorine/dev/holochain/holochain-engineers/team-mates/node_modules/@holochain/client/lib/api/admin/websocket.js"],"names":["Api","WsClient","catchError","promiseTimeout","DEFAULT_TIMEOUT","requesterTransformer","getLauncherEnvironment","AdminWebsocket","client","defaultTimeout","constructor","undefined","connect","url","env","ADMIN_INTERFACE_PORT","wsClient","_requester","tag","transformer","req","timeout","request","then","attachAppInterface","activateApp","deactivateApp","enableApp","disableApp","startApp","dumpState","dumpStateTransform","dumpFullState","generateAgentPubKey","registerDna","installApp","uninstallApp","installAppBundle","createCloneCell","listDnas","listCellIds","listActiveApps","listApps","listAppsTransform","listAppInterfaces","requestAgentInfo","addAgentInfo","input","args","status_filter","getAppStatusInApiForm","output","res","JSON","parse","AppStatusFilter","Running","Enabled","Paused","Disabled","Stopped"],"mappings":"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","sourcesContent":["/**\n * Defines AdminWebsocket, an easy-to-use websocket implementation of the\n * Conductor Admin API\n *\n *    const client = AdminWebsocket.connect(\n *      'ws://localhost:9000'\n *    )\n *\n *    client.generateAgentPubKey()\n *      .then(agentPubKey => {\n *        console.log('Agent successfully generated:', agentPubKey)\n *      })\n *      .catch(err => {\n *        console.error('problem generating agent:', err)\n *      })\n */\nimport * as Api from \"./types.js\";\nimport { WsClient } from \"../client.js\";\nimport { catchError, promiseTimeout, DEFAULT_TIMEOUT } from \"../common.js\";\nimport { requesterTransformer } from \"../common.js\";\nimport { getLauncherEnvironment } from \"../../environments/launcher.js\";\nexport class AdminWebsocket {\n    client;\n    defaultTimeout;\n    constructor(client, defaultTimeout) {\n        this.client = client;\n        this.defaultTimeout =\n            defaultTimeout === undefined ? DEFAULT_TIMEOUT : defaultTimeout;\n    }\n    static async connect(url, defaultTimeout) {\n        // Check if we are in the launcher's environment, and if so, redirect the url to connect to\n        const env = await getLauncherEnvironment();\n        if (env) {\n            url = `ws://localhost:${env.ADMIN_INTERFACE_PORT}`;\n        }\n        const wsClient = await WsClient.connect(url);\n        return new AdminWebsocket(wsClient, defaultTimeout);\n    }\n    _requester = (tag, transformer) => requesterTransformer((req, timeout) => promiseTimeout(this.client.request(req), tag, timeout || this.defaultTimeout).then(catchError), tag, transformer);\n    // the specific request/response types come from the Interface\n    // which this class implements\n    attachAppInterface = this._requester(\"attach_app_interface\");\n    // Deprecated\n    activateApp = this._requester(\"activate_app\");\n    // Deprecated\n    deactivateApp = this._requester(\"deactivate_app\");\n    enableApp = this._requester(\"enable_app\");\n    disableApp = this._requester(\"disable_app\");\n    startApp = this._requester(\"start_app\");\n    dumpState = this._requester(\"dump_state\", dumpStateTransform);\n    dumpFullState = this._requester(\"dump_full_state\");\n    generateAgentPubKey = this._requester(\"generate_agent_pub_key\");\n    registerDna = this._requester(\"register_dna\");\n    installApp = this._requester(\"install_app\");\n    uninstallApp = this._requester(\"uninstall_app\");\n    installAppBundle = this._requester(\"install_app_bundle\");\n    createCloneCell = this._requester(\"create_clone_cell\");\n    listDnas = this._requester(\"list_dnas\");\n    listCellIds = this._requester(\"list_cell_ids\");\n    // Deprecated\n    listActiveApps = this._requester(\"list_active_apps\");\n    listApps = this._requester(\"list_apps\", listAppsTransform);\n    listAppInterfaces = this._requester(\"list_app_interfaces\");\n    requestAgentInfo = this._requester(\"request_agent_info\");\n    addAgentInfo = this._requester(\"add_agent_info\");\n}\nconst listAppsTransform = {\n    input: (req) => {\n        const args = {};\n        if (req.status_filter) {\n            args.status_filter = getAppStatusInApiForm(req.status_filter);\n        }\n        return args;\n    },\n    output: (res) => res,\n};\nconst dumpStateTransform = {\n    input: (req) => req,\n    output: (res) => {\n        return JSON.parse(res);\n    },\n};\nfunction getAppStatusInApiForm(status_filter) {\n    switch (status_filter) {\n        case Api.AppStatusFilter.Running:\n            return {\n                Running: null,\n            };\n        case Api.AppStatusFilter.Enabled:\n            return {\n                Enabled: null,\n            };\n        case Api.AppStatusFilter.Paused:\n            return {\n                Paused: null,\n            };\n        case Api.AppStatusFilter.Disabled:\n            return {\n                Disabled: null,\n            };\n        case Api.AppStatusFilter.Stopped:\n            return {\n                Stopped: null,\n            };\n    }\n}\n"]},"metadata":{},"sourceType":"module"}